<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>XMonad/Util/XUtils.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-2"></a><span class='hs-comment'>-- |</span>
<a name="line-3"></a><span class='hs-comment'>-- Module      :  XMonad.Util.XUtils</span>
<a name="line-4"></a><span class='hs-comment'>-- Copyright   :  (c) 2007 Andrea Rossato</span>
<a name="line-5"></a><span class='hs-comment'>--                    2010 Alejandro Serrano</span>
<a name="line-6"></a><span class='hs-comment'>-- License     :  BSD-style (see xmonad/LICENSE)</span>
<a name="line-7"></a><span class='hs-comment'>--</span>
<a name="line-8"></a><span class='hs-comment'>-- Maintainer  :  andrea.rossato@unibz.it</span>
<a name="line-9"></a><span class='hs-comment'>-- Stability   :  unstable</span>
<a name="line-10"></a><span class='hs-comment'>-- Portability :  unportable</span>
<a name="line-11"></a><span class='hs-comment'>--</span>
<a name="line-12"></a><span class='hs-comment'>-- A module for painting on the screen</span>
<a name="line-13"></a><span class='hs-comment'>--</span>
<a name="line-14"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-15"></a>
<a name="line-16"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>Util</span><span class='hs-varop'>.</span><span class='hs-conid'>XUtils</span>
<a name="line-17"></a>    <span class='hs-layout'>(</span> <span class='hs-comment'>-- * Usage:</span>
<a name="line-18"></a>      <span class='hs-comment'>-- $usage</span>
<a name="line-19"></a>      <span class='hs-varid'>averagePixels</span>
<a name="line-20"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>createNewWindow</span>
<a name="line-21"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>showWindow</span>
<a name="line-22"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>showWindows</span>
<a name="line-23"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>hideWindow</span>
<a name="line-24"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>hideWindows</span>
<a name="line-25"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>deleteWindow</span>
<a name="line-26"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>deleteWindows</span>
<a name="line-27"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>paintWindow</span>
<a name="line-28"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>paintAndWrite</span>
<a name="line-29"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>paintTextAndIcons</span>
<a name="line-30"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>stringToPixel</span>
<a name="line-31"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>fi</span>
<a name="line-32"></a>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-33"></a>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Maybe</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>XMonad</span>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>Util</span><span class='hs-varop'>.</span><span class='hs-conid'>Font</span>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>Util</span><span class='hs-varop'>.</span><span class='hs-conid'>Image</span>
<a name="line-38"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Monad</span>
<a name="line-39"></a>
<a name="line-40"></a><span class='hs-comment'>-- $usage</span>
<a name="line-41"></a><span class='hs-comment'>-- See "XMonad.Layout.Tabbed" or "XMonad.Layout.DragPane" or</span>
<a name="line-42"></a><span class='hs-comment'>-- "XMonad.Layout.Decoration" for usage examples</span>
<a name="line-43"></a>
<a name="line-44"></a><a name="averagePixels"></a><span class='hs-comment'>-- | Compute the weighted average the colors of two given Pixel values.</span>
<a name="line-45"></a><span class='hs-definition'>averagePixels</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pixel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pixel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Pixel</span>
<a name="line-46"></a><span class='hs-definition'>averagePixels</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span>
<a name="line-47"></a>    <span class='hs-keyword'>do</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-48"></a>       <span class='hs-keyword'>let</span> <span class='hs-varid'>cm</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>defaultColormap</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-varid'>defaultScreen</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-49"></a>       <span class='hs-keyglyph'>[</span><span class='hs-conid'>Color</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>r1</span> <span class='hs-varid'>g1</span> <span class='hs-varid'>b1</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-conid'>Color</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>r2</span> <span class='hs-varid'>g2</span> <span class='hs-varid'>b2</span> <span class='hs-keyword'>_</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>queryColors</span> <span class='hs-varid'>d</span> <span class='hs-varid'>cm</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Color</span> <span class='hs-varid'>p1</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-conid'>Color</span> <span class='hs-varid'>p2</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span><span class='hs-keyglyph'>]</span>
<a name="line-50"></a>       <span class='hs-keyword'>let</span> <span class='hs-varid'>mn</span> <span class='hs-varid'>x1</span> <span class='hs-varid'>x2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>round</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x1</span> <span class='hs-varop'>*</span> <span class='hs-varid'>f</span> <span class='hs-varop'>+</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x2</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span><span class='hs-comment'>-</span><span class='hs-varid'>f</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-51"></a>       <span class='hs-conid'>Color</span> <span class='hs-varid'>p</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>allocColor</span> <span class='hs-varid'>d</span> <span class='hs-varid'>cm</span> <span class='hs-layout'>(</span><span class='hs-conid'>Color</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>mn</span> <span class='hs-varid'>r1</span> <span class='hs-varid'>r2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mn</span> <span class='hs-varid'>g1</span> <span class='hs-varid'>g2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mn</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<a name="line-52"></a>       <span class='hs-varid'>return</span> <span class='hs-varid'>p</span>
<a name="line-53"></a>
<a name="line-54"></a><a name="createNewWindow"></a><span class='hs-comment'>-- | Create a simple window given a rectangle. If Nothing is given</span>
<a name="line-55"></a><span class='hs-comment'>-- only the exposureMask will be set, otherwise the Just value.</span>
<a name="line-56"></a><span class='hs-comment'>-- Use 'showWindow' to map and hideWindow to unmap.</span>
<a name="line-57"></a><span class='hs-definition'>createNewWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Rectangle</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>EventMask</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Window</span>
<a name="line-58"></a><span class='hs-definition'>createNewWindow</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>w</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>col</span> <span class='hs-varid'>o</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-59"></a>  <span class='hs-varid'>d</span>   <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-60"></a>  <span class='hs-varid'>rw</span>  <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>theRoot</span>
<a name="line-61"></a>  <span class='hs-varid'>c</span>   <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>stringToPixel</span> <span class='hs-varid'>d</span> <span class='hs-varid'>col</span>
<a name="line-62"></a>  <span class='hs-varid'>win</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>mkWindow</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-varid'>defaultScreenOfDisplay</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>rw</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>w</span> <span class='hs-varid'>h</span> <span class='hs-varid'>c</span> <span class='hs-varid'>o</span>
<a name="line-63"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>of</span>
<a name="line-64"></a>    <span class='hs-conid'>Just</span> <span class='hs-varid'>em</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>selectInput</span> <span class='hs-varid'>d</span> <span class='hs-varid'>win</span> <span class='hs-varid'>em</span>
<a name="line-65"></a>    <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>selectInput</span> <span class='hs-varid'>d</span> <span class='hs-varid'>win</span> <span class='hs-varid'>exposureMask</span>
<a name="line-66"></a>  <span class='hs-comment'>-- @@@ ugly hack to prevent compositing</span>
<a name="line-67"></a>  <span class='hs-varid'>whenX</span> <span class='hs-layout'>(</span><span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>isJust</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>flip</span> <span class='hs-varid'>catchX</span> <span class='hs-layout'>(</span><span class='hs-varid'>return</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-68"></a>    <span class='hs-varid'>wINDOW_TYPE</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getAtom</span> <span class='hs-str'>"_NET_WM_WINDOW_TYPE"</span>
<a name="line-69"></a>    <span class='hs-varid'>dESKTOP</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getAtom</span> <span class='hs-str'>"_NET_WM_WINDOW_TYPE_DESKTOP"</span>
<a name="line-70"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>changeProperty32</span> <span class='hs-varid'>d</span> <span class='hs-varid'>win</span> <span class='hs-varid'>wINDOW_TYPE</span> <span class='hs-varid'>aTOM</span> <span class='hs-varid'>propModeReplace</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>fi</span> <span class='hs-varid'>dESKTOP</span><span class='hs-keyglyph'>]</span>
<a name="line-71"></a>  <span class='hs-varid'>return</span> <span class='hs-varid'>win</span>
<a name="line-72"></a>
<a name="line-73"></a><a name="showWindow"></a><span class='hs-comment'>-- | Map a window</span>
<a name="line-74"></a><span class='hs-definition'>showWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-75"></a><span class='hs-definition'>showWindow</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-76"></a>  <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-77"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>mapWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-78"></a>
<a name="line-79"></a><a name="showWindows"></a><span class='hs-comment'>-- | the list version</span>
<a name="line-80"></a><span class='hs-definition'>showWindows</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Window</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-81"></a><span class='hs-definition'>showWindows</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mapM_</span> <span class='hs-varid'>showWindow</span>
<a name="line-82"></a>
<a name="line-83"></a><a name="hideWindow"></a><span class='hs-comment'>-- | unmap a window</span>
<a name="line-84"></a><span class='hs-definition'>hideWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-85"></a><span class='hs-definition'>hideWindow</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-86"></a>  <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-87"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>unmapWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-88"></a>
<a name="line-89"></a><a name="hideWindows"></a><span class='hs-comment'>-- | the list version</span>
<a name="line-90"></a><span class='hs-definition'>hideWindows</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Window</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-91"></a><span class='hs-definition'>hideWindows</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mapM_</span> <span class='hs-varid'>hideWindow</span>
<a name="line-92"></a>
<a name="line-93"></a><a name="deleteWindow"></a><span class='hs-comment'>-- | destroy a window</span>
<a name="line-94"></a><span class='hs-definition'>deleteWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-95"></a><span class='hs-definition'>deleteWindow</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-96"></a>  <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-97"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>destroyWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-98"></a>
<a name="line-99"></a><a name="deleteWindows"></a><span class='hs-comment'>-- | the list version</span>
<a name="line-100"></a><span class='hs-definition'>deleteWindows</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Window</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-101"></a><span class='hs-definition'>deleteWindows</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mapM_</span> <span class='hs-varid'>deleteWindow</span>
<a name="line-102"></a>
<a name="line-103"></a><a name="paintWindow"></a><span class='hs-comment'>-- | Fill a window with a rectangle and a border</span>
<a name="line-104"></a><span class='hs-definition'>paintWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span>     <span class='hs-comment'>-- ^ The window where to draw</span>
<a name="line-105"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>  <span class='hs-comment'>-- ^ Window width</span>
<a name="line-106"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>  <span class='hs-comment'>-- ^ Window height</span>
<a name="line-107"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>  <span class='hs-comment'>-- ^ Border width</span>
<a name="line-108"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>     <span class='hs-comment'>-- ^ Window background color</span>
<a name="line-109"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>     <span class='hs-comment'>-- ^ Border color</span>
<a name="line-110"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-111"></a><span class='hs-definition'>paintWindow</span> <span class='hs-varid'>w</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span> <span class='hs-varid'>bw</span> <span class='hs-varid'>c</span> <span class='hs-varid'>bc</span> <span class='hs-keyglyph'>=</span>
<a name="line-112"></a>    <span class='hs-varid'>paintWindow'</span> <span class='hs-varid'>w</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span><span class='hs-layout'>)</span> <span class='hs-varid'>bw</span> <span class='hs-varid'>c</span> <span class='hs-varid'>bc</span> <span class='hs-conid'>Nothing</span> <span class='hs-conid'>Nothing</span>
<a name="line-113"></a>
<a name="line-114"></a><a name="paintAndWrite"></a><span class='hs-comment'>-- | Fill a window with a rectangle and a border, and write</span>
<a name="line-115"></a><span class='hs-comment'>-- | a number of strings to given positions</span>
<a name="line-116"></a><span class='hs-definition'>paintAndWrite</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span>     <span class='hs-comment'>-- ^ The window where to draw</span>
<a name="line-117"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>XMonadFont</span> <span class='hs-comment'>-- ^ XMonad Font for drawing</span>
<a name="line-118"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>  <span class='hs-comment'>-- ^ Window width</span>
<a name="line-119"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>  <span class='hs-comment'>-- ^ Window height</span>
<a name="line-120"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>  <span class='hs-comment'>-- ^ Border width</span>
<a name="line-121"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>     <span class='hs-comment'>-- ^ Window background color</span>
<a name="line-122"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>     <span class='hs-comment'>-- ^ Border color</span>
<a name="line-123"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>     <span class='hs-comment'>-- ^ String color</span>
<a name="line-124"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>     <span class='hs-comment'>-- ^ String background color</span>
<a name="line-125"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Align</span><span class='hs-keyglyph'>]</span>    <span class='hs-comment'>-- ^ String 'Align'ments</span>
<a name="line-126"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span>   <span class='hs-comment'>-- ^ Strings to be printed</span>
<a name="line-127"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-128"></a><span class='hs-definition'>paintAndWrite</span> <span class='hs-varid'>w</span> <span class='hs-varid'>fs</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span> <span class='hs-varid'>bw</span> <span class='hs-varid'>bc</span> <span class='hs-varid'>borc</span> <span class='hs-varid'>ffc</span> <span class='hs-varid'>fbc</span> <span class='hs-varid'>als</span> <span class='hs-varid'>strs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-129"></a>    <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-130"></a>    <span class='hs-varid'>strPositions</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>forM</span> <span class='hs-layout'>(</span><span class='hs-varid'>zip</span> <span class='hs-varid'>als</span> <span class='hs-varid'>strs</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>al</span><span class='hs-layout'>,</span> <span class='hs-varid'>str</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-131"></a>        <span class='hs-varid'>stringPosition</span> <span class='hs-varid'>d</span> <span class='hs-varid'>fs</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span><span class='hs-layout'>)</span> <span class='hs-varid'>al</span> <span class='hs-varid'>str</span>
<a name="line-132"></a>    <span class='hs-keyword'>let</span> <span class='hs-varid'>ms</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>fs</span><span class='hs-layout'>,</span><span class='hs-varid'>ffc</span><span class='hs-layout'>,</span><span class='hs-varid'>fbc</span><span class='hs-layout'>,</span> <span class='hs-varid'>zip</span> <span class='hs-varid'>strs</span> <span class='hs-varid'>strPositions</span><span class='hs-layout'>)</span>
<a name="line-133"></a>    <span class='hs-varid'>paintWindow'</span> <span class='hs-varid'>w</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span><span class='hs-layout'>)</span> <span class='hs-varid'>bw</span> <span class='hs-varid'>bc</span> <span class='hs-varid'>borc</span> <span class='hs-varid'>ms</span> <span class='hs-conid'>Nothing</span>
<a name="line-134"></a>
<a name="line-135"></a><a name="paintTextAndIcons"></a><span class='hs-comment'>-- | Fill a window with a rectangle and a border, and write</span>
<a name="line-136"></a><span class='hs-comment'>-- | a number of strings and a number of icons to given positions</span>
<a name="line-137"></a><span class='hs-definition'>paintTextAndIcons</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span>      <span class='hs-comment'>-- ^ The window where to draw</span>
<a name="line-138"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>XMonadFont</span>  <span class='hs-comment'>-- ^ XMonad Font for drawing</span>
<a name="line-139"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>   <span class='hs-comment'>-- ^ Window width</span>
<a name="line-140"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>   <span class='hs-comment'>-- ^ Window height</span>
<a name="line-141"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span>   <span class='hs-comment'>-- ^ Border width</span>
<a name="line-142"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>      <span class='hs-comment'>-- ^ Window background color</span>
<a name="line-143"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>      <span class='hs-comment'>-- ^ Border color</span>
<a name="line-144"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>      <span class='hs-comment'>-- ^ String color</span>
<a name="line-145"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>      <span class='hs-comment'>-- ^ String background color</span>
<a name="line-146"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Align</span><span class='hs-keyglyph'>]</span>     <span class='hs-comment'>-- ^ String 'Align'ments</span>
<a name="line-147"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span>    <span class='hs-comment'>-- ^ Strings to be printed</span>
<a name="line-148"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Placement</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- ^ Icon 'Placements'</span>
<a name="line-149"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Bool</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>  <span class='hs-comment'>-- ^ Icons to be printed</span>
<a name="line-150"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-151"></a><span class='hs-definition'>paintTextAndIcons</span> <span class='hs-varid'>w</span> <span class='hs-varid'>fs</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span> <span class='hs-varid'>bw</span> <span class='hs-varid'>bc</span> <span class='hs-varid'>borc</span> <span class='hs-varid'>ffc</span> <span class='hs-varid'>fbc</span> <span class='hs-varid'>als</span> <span class='hs-varid'>strs</span> <span class='hs-varid'>i_als</span> <span class='hs-varid'>icons</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-152"></a>    <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-153"></a>    <span class='hs-varid'>strPositions</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>forM</span> <span class='hs-layout'>(</span><span class='hs-varid'>zip</span> <span class='hs-varid'>als</span> <span class='hs-varid'>strs</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>al</span><span class='hs-layout'>,</span> <span class='hs-varid'>str</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-154"></a>        <span class='hs-varid'>stringPosition</span> <span class='hs-varid'>d</span> <span class='hs-varid'>fs</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span><span class='hs-layout'>)</span> <span class='hs-varid'>al</span> <span class='hs-varid'>str</span>
<a name="line-155"></a>    <span class='hs-keyword'>let</span> <span class='hs-varid'>iconPositions</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>al</span><span class='hs-layout'>,</span> <span class='hs-varid'>icon</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>iconPosition</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span><span class='hs-layout'>)</span> <span class='hs-varid'>al</span> <span class='hs-varid'>icon</span> <span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>zip</span> <span class='hs-varid'>i_als</span> <span class='hs-varid'>icons</span><span class='hs-layout'>)</span>
<a name="line-156"></a>        <span class='hs-varid'>ms</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>fs</span><span class='hs-layout'>,</span><span class='hs-varid'>ffc</span><span class='hs-layout'>,</span><span class='hs-varid'>fbc</span><span class='hs-layout'>,</span> <span class='hs-varid'>zip</span> <span class='hs-varid'>strs</span> <span class='hs-varid'>strPositions</span><span class='hs-layout'>)</span>
<a name="line-157"></a>        <span class='hs-varid'>is</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>ffc</span><span class='hs-layout'>,</span> <span class='hs-varid'>fbc</span><span class='hs-layout'>,</span> <span class='hs-varid'>zip</span> <span class='hs-varid'>iconPositions</span> <span class='hs-varid'>icons</span><span class='hs-layout'>)</span>
<a name="line-158"></a>    <span class='hs-varid'>paintWindow'</span> <span class='hs-varid'>w</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span><span class='hs-layout'>)</span> <span class='hs-varid'>bw</span> <span class='hs-varid'>bc</span> <span class='hs-varid'>borc</span> <span class='hs-varid'>ms</span> <span class='hs-varid'>is</span>
<a name="line-159"></a>
<a name="line-160"></a><span class='hs-comment'>-- This stuff is not exported</span>
<a name="line-161"></a>
<a name="line-162"></a><a name="paintWindow'"></a><span class='hs-comment'>-- | Paints a titlebar with some strings and icons</span>
<a name="line-163"></a><span class='hs-comment'>-- drawn inside it.</span>
<a name="line-164"></a><span class='hs-comment'>-- Not exported.</span>
<a name="line-165"></a><span class='hs-definition'>paintWindow'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Rectangle</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-166"></a>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>XMonadFont</span><span class='hs-layout'>,</span><span class='hs-conid'>String</span><span class='hs-layout'>,</span><span class='hs-conid'>String</span><span class='hs-layout'>,</span><span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>String</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-conid'>Position</span><span class='hs-layout'>,</span> <span class='hs-conid'>Position</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-167"></a>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>String</span><span class='hs-layout'>,</span> <span class='hs-conid'>String</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>Position</span><span class='hs-layout'>,</span> <span class='hs-conid'>Position</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Bool</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-168"></a><span class='hs-definition'>paintWindow'</span> <span class='hs-varid'>win</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rectangle</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span><span class='hs-layout'>)</span> <span class='hs-varid'>bw</span> <span class='hs-varid'>color</span> <span class='hs-varid'>b_color</span> <span class='hs-varid'>strStuff</span> <span class='hs-varid'>iconStuff</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-169"></a>  <span class='hs-varid'>d</span>  <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-170"></a>  <span class='hs-varid'>p</span>  <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createPixmap</span> <span class='hs-varid'>d</span> <span class='hs-varid'>win</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span> <span class='hs-layout'>(</span><span class='hs-varid'>defaultDepthOfScreen</span> <span class='hs-varop'>$</span> <span class='hs-varid'>defaultScreenOfDisplay</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-171"></a>  <span class='hs-varid'>gc</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>createGC</span> <span class='hs-varid'>d</span> <span class='hs-varid'>p</span>
<a name="line-172"></a>  <span class='hs-comment'>-- draw</span>
<a name="line-173"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>setGraphicsExposures</span> <span class='hs-varid'>d</span> <span class='hs-varid'>gc</span> <span class='hs-conid'>False</span>
<a name="line-174"></a>  <span class='hs-keyglyph'>[</span><span class='hs-varid'>color'</span><span class='hs-layout'>,</span><span class='hs-varid'>b_color'</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>mapM</span> <span class='hs-layout'>(</span><span class='hs-varid'>stringToPixel</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>color</span><span class='hs-layout'>,</span><span class='hs-varid'>b_color</span><span class='hs-keyglyph'>]</span>
<a name="line-175"></a>  <span class='hs-comment'>-- we start with the border</span>
<a name="line-176"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>setForeground</span> <span class='hs-varid'>d</span> <span class='hs-varid'>gc</span> <span class='hs-varid'>b_color'</span>
<a name="line-177"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fillRectangle</span> <span class='hs-varid'>d</span> <span class='hs-varid'>p</span> <span class='hs-varid'>gc</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span>
<a name="line-178"></a>  <span class='hs-comment'>-- and now again</span>
<a name="line-179"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>setForeground</span> <span class='hs-varid'>d</span> <span class='hs-varid'>gc</span> <span class='hs-varid'>color'</span>
<a name="line-180"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fillRectangle</span> <span class='hs-varid'>d</span> <span class='hs-varid'>p</span> <span class='hs-varid'>gc</span> <span class='hs-layout'>(</span><span class='hs-varid'>fi</span> <span class='hs-varid'>bw</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>fi</span> <span class='hs-varid'>bw</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>wh</span> <span class='hs-comment'>-</span> <span class='hs-layout'>(</span><span class='hs-varid'>bw</span> <span class='hs-varop'>*</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ht</span> <span class='hs-comment'>-</span> <span class='hs-layout'>(</span><span class='hs-varid'>bw</span> <span class='hs-varop'>*</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-181"></a>  <span class='hs-comment'>-- paint strings</span>
<a name="line-182"></a>  <span class='hs-varid'>when</span> <span class='hs-layout'>(</span><span class='hs-varid'>isJust</span> <span class='hs-varid'>strStuff</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-183"></a>    <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>xmf</span><span class='hs-layout'>,</span><span class='hs-varid'>fc</span><span class='hs-layout'>,</span><span class='hs-varid'>bc</span><span class='hs-layout'>,</span><span class='hs-varid'>strAndPos</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromJust</span> <span class='hs-varid'>strStuff</span>
<a name="line-184"></a>    <span class='hs-varid'>forM_</span> <span class='hs-varid'>strAndPos</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-185"></a>        <span class='hs-varid'>printStringXMF</span> <span class='hs-varid'>d</span> <span class='hs-varid'>p</span> <span class='hs-varid'>xmf</span> <span class='hs-varid'>gc</span> <span class='hs-varid'>fc</span> <span class='hs-varid'>bc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>s</span>
<a name="line-186"></a>  <span class='hs-comment'>-- paint icons</span>
<a name="line-187"></a>  <span class='hs-varid'>when</span> <span class='hs-layout'>(</span><span class='hs-varid'>isJust</span> <span class='hs-varid'>iconStuff</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-188"></a>    <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>fc</span><span class='hs-layout'>,</span> <span class='hs-varid'>bc</span><span class='hs-layout'>,</span> <span class='hs-varid'>iconAndPos</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromJust</span> <span class='hs-varid'>iconStuff</span>
<a name="line-189"></a>    <span class='hs-varid'>forM_</span> <span class='hs-varid'>iconAndPos</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>icon</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-190"></a>      <span class='hs-varid'>drawIcon</span> <span class='hs-varid'>d</span> <span class='hs-varid'>p</span> <span class='hs-varid'>gc</span> <span class='hs-varid'>fc</span> <span class='hs-varid'>bc</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>icon</span>
<a name="line-191"></a>  <span class='hs-comment'>-- copy the pixmap over the window</span>
<a name="line-192"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>copyArea</span>      <span class='hs-varid'>d</span> <span class='hs-varid'>p</span> <span class='hs-varid'>win</span> <span class='hs-varid'>gc</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>wh</span> <span class='hs-varid'>ht</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<a name="line-193"></a>  <span class='hs-comment'>-- free the pixmap and GC</span>
<a name="line-194"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>freePixmap</span>    <span class='hs-varid'>d</span> <span class='hs-varid'>p</span>
<a name="line-195"></a>  <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>freeGC</span>        <span class='hs-varid'>d</span> <span class='hs-varid'>gc</span>
<a name="line-196"></a>
<a name="line-197"></a><a name="mkWindow"></a><span class='hs-comment'>-- | Creates a window with the possibility of setting some attributes.</span>
<a name="line-198"></a><span class='hs-comment'>-- Not exported.</span>
<a name="line-199"></a><span class='hs-definition'>mkWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Display</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Screen</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Position</span>
<a name="line-200"></a>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Position</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dimension</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pixel</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Window</span>
<a name="line-201"></a><span class='hs-definition'>mkWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>s</span> <span class='hs-varid'>rw</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>w</span> <span class='hs-varid'>h</span> <span class='hs-varid'>p</span> <span class='hs-varid'>o</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-202"></a>  <span class='hs-keyword'>let</span> <span class='hs-varid'>visual</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>defaultVisualOfScreen</span> <span class='hs-varid'>s</span>
<a name="line-203"></a>      <span class='hs-varid'>attrmask</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cWOverrideRedirect</span> <span class='hs-varop'>.|.</span> <span class='hs-varid'>cWBackPixel</span> <span class='hs-varop'>.|.</span> <span class='hs-varid'>cWBorderPixel</span>
<a name="line-204"></a>  <span class='hs-varid'>allocaSetWindowAttributes</span> <span class='hs-varop'>$</span>
<a name="line-205"></a>         <span class='hs-keyglyph'>\</span><span class='hs-varid'>attributes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-206"></a>           <span class='hs-varid'>set_override_redirect</span> <span class='hs-varid'>attributes</span> <span class='hs-varid'>o</span>
<a name="line-207"></a>           <span class='hs-varid'>set_border_pixel</span>      <span class='hs-varid'>attributes</span> <span class='hs-varid'>p</span>
<a name="line-208"></a>           <span class='hs-varid'>set_background_pixel</span>  <span class='hs-varid'>attributes</span> <span class='hs-varid'>p</span>
<a name="line-209"></a>           <span class='hs-varid'>createWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>rw</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>w</span> <span class='hs-varid'>h</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>defaultDepthOfScreen</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>
<a name="line-210"></a>                        <span class='hs-varid'>inputOutput</span> <span class='hs-varid'>visual</span> <span class='hs-varid'>attrmask</span> <span class='hs-varid'>attributes</span>
<a name="line-211"></a>
</pre></body>
</html>
