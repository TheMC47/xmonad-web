<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>XMonad/Actions/FloatKeys.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-2"></a><span class='hs-comment'>-- |</span>
<a name="line-3"></a><span class='hs-comment'>-- Module       : XMonad.Actions.FloatKeys</span>
<a name="line-4"></a><span class='hs-comment'>-- Copyright    : (c) Karsten Schoelzel &lt;kuser@gmx.de&gt;</span>
<a name="line-5"></a><span class='hs-comment'>-- License      : BSD</span>
<a name="line-6"></a><span class='hs-comment'>--</span>
<a name="line-7"></a><span class='hs-comment'>-- Maintainer   : Karsten Schoelzel &lt;kuser@gmx.de&gt;</span>
<a name="line-8"></a><span class='hs-comment'>-- Stability    : stable</span>
<a name="line-9"></a><span class='hs-comment'>-- Portability  : unportable</span>
<a name="line-10"></a><span class='hs-comment'>--</span>
<a name="line-11"></a><span class='hs-comment'>-- Move and resize floating windows.</span>
<a name="line-12"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-13"></a>
<a name="line-14"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>Actions</span><span class='hs-varop'>.</span><span class='hs-conid'>FloatKeys</span> <span class='hs-layout'>(</span>
<a name="line-15"></a>                <span class='hs-comment'>-- * Usage</span>
<a name="line-16"></a>                <span class='hs-comment'>-- $usage</span>
<a name="line-17"></a>                <span class='hs-varid'>keysMoveWindow</span><span class='hs-layout'>,</span>
<a name="line-18"></a>                <span class='hs-varid'>keysMoveWindowTo</span><span class='hs-layout'>,</span>
<a name="line-19"></a>                <span class='hs-varid'>keysResizeWindow</span><span class='hs-layout'>,</span>
<a name="line-20"></a>                <span class='hs-varid'>keysAbsResizeWindow</span><span class='hs-layout'>,</span>
<a name="line-21"></a>                <span class='hs-conid'>P</span><span class='hs-layout'>,</span> <span class='hs-conid'>G</span><span class='hs-layout'>,</span>
<a name="line-22"></a>                <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-23"></a>
<a name="line-24"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>XMonad</span>
<a name="line-25"></a>
<a name="line-26"></a><span class='hs-comment'>-- $usage</span>
<a name="line-27"></a><span class='hs-comment'>-- You can use this module with the following in your @~\/.xmonad\/xmonad.hs@:</span>
<a name="line-28"></a><span class='hs-comment'>--</span>
<a name="line-29"></a><span class='hs-comment'>-- &gt;    import XMonad.Actions.FloatKeys</span>
<a name="line-30"></a><span class='hs-comment'>--</span>
<a name="line-31"></a><span class='hs-comment'>-- Then add appropriate key bindings, for example:</span>
<a name="line-32"></a><span class='hs-comment'>--</span>
<a name="line-33"></a><span class='hs-comment'>-- &gt;  , ((modm,               xK_d     ), withFocused (keysResizeWindow (-10,-10) (1,1)))</span>
<a name="line-34"></a><span class='hs-comment'>-- &gt;  , ((modm,               xK_s     ), withFocused (keysResizeWindow (10,10) (1,1)))</span>
<a name="line-35"></a><span class='hs-comment'>-- &gt;  , ((modm .|. shiftMask, xK_d     ), withFocused (keysAbsResizeWindow (-10,-10) (1024,752)))</span>
<a name="line-36"></a><span class='hs-comment'>-- &gt;  , ((modm .|. shiftMask, xK_s     ), withFocused (keysAbsResizeWindow (10,10) (1024,752)))</span>
<a name="line-37"></a><span class='hs-comment'>-- &gt;  , ((modm,               xK_a     ), withFocused (keysMoveWindowTo (512,384) (1%2,1%2)))</span>
<a name="line-38"></a><span class='hs-comment'>--</span>
<a name="line-39"></a><span class='hs-comment'>-- For detailed instructions on editing your key bindings, see</span>
<a name="line-40"></a><span class='hs-comment'>-- "XMonad.Doc.Extending#Editing_key_bindings".</span>
<a name="line-41"></a>
<a name="line-42"></a><a name="keysMoveWindow"></a><span class='hs-comment'>-- | @keysMoveWindow (dx, dy)@ moves the window by @dx@ pixels to the</span>
<a name="line-43"></a><span class='hs-comment'>--   right and @dy@ pixels down.</span>
<a name="line-44"></a><span class='hs-definition'>keysMoveWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-45"></a><span class='hs-definition'>keysMoveWindow</span> <span class='hs-layout'>(</span><span class='hs-varid'>dx</span><span class='hs-layout'>,</span><span class='hs-varid'>dy</span><span class='hs-layout'>)</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>whenX</span> <span class='hs-layout'>(</span><span class='hs-varid'>isClient</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>withDisplay</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-46"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>raiseWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-47"></a>    <span class='hs-varid'>wa</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getWindowAttributes</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-48"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>moveWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>wa_x</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-varid'>dx</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-49"></a>                        <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>wa_y</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-varid'>dy</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-50"></a>    <span class='hs-varid'>float</span> <span class='hs-varid'>w</span>
<a name="line-51"></a>
<a name="line-52"></a><a name="keysMoveWindowTo"></a><span class='hs-comment'>-- | @keysMoveWindowTo (x, y) (gx, gy)@ moves the window relative</span>
<a name="line-53"></a><span class='hs-comment'>--   point @(gx, gy)@ to the point @(x,y)@, where @(gx,gy)@ gives a</span>
<a name="line-54"></a><span class='hs-comment'>--   position relative to the window border, i.e.  @gx = 0@ is the left</span>
<a name="line-55"></a><span class='hs-comment'>--   border, @gx = 1@ is the right border, @gy = 0@ is the top border, and</span>
<a name="line-56"></a><span class='hs-comment'>--   @gy = 1@ the bottom border.</span>
<a name="line-57"></a><span class='hs-comment'>--</span>
<a name="line-58"></a><span class='hs-comment'>--   For example, on a 1024x768 screen:</span>
<a name="line-59"></a><span class='hs-comment'>--</span>
<a name="line-60"></a><span class='hs-comment'>-- &gt; keysMoveWindowTo (512,384) (1%2, 1%2) -- center the window on screen</span>
<a name="line-61"></a><span class='hs-comment'>-- &gt; keysMoveWindowTo (1024,0) (1, 0)      -- put window in the top right corner</span>
<a name="line-62"></a><span class='hs-definition'>keysMoveWindowTo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>P</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>G</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-63"></a><span class='hs-definition'>keysMoveWindowTo</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>gx</span><span class='hs-layout'>,</span> <span class='hs-varid'>gy</span><span class='hs-layout'>)</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>whenX</span> <span class='hs-layout'>(</span><span class='hs-varid'>isClient</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>withDisplay</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-64"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>raiseWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-65"></a>    <span class='hs-varid'>wa</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getWindowAttributes</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-66"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>moveWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-comment'>-</span> <span class='hs-varid'>round</span> <span class='hs-layout'>(</span><span class='hs-varid'>gx</span> <span class='hs-varop'>*</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>wa_width</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-67"></a>                        <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-comment'>-</span> <span class='hs-varid'>round</span> <span class='hs-layout'>(</span><span class='hs-varid'>gy</span> <span class='hs-varop'>*</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>wa_height</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-68"></a>    <span class='hs-varid'>float</span> <span class='hs-varid'>w</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="G"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>G</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rational</span><span class='hs-layout'>,</span> <span class='hs-conid'>Rational</span><span class='hs-layout'>)</span>
<a name="line-71"></a><a name="P"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>P</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Position</span><span class='hs-layout'>,</span> <span class='hs-conid'>Position</span><span class='hs-layout'>)</span>
<a name="line-72"></a>
<a name="line-73"></a><a name="keysResizeWindow"></a><span class='hs-comment'>-- | @keysResizeWindow (dx, dy) (gx, gy)@ changes the width by @dx@</span>
<a name="line-74"></a><span class='hs-comment'>--   and the height by @dy@, leaving the window-relative point @(gx,</span>
<a name="line-75"></a><span class='hs-comment'>--   gy)@ fixed.</span>
<a name="line-76"></a><span class='hs-comment'>--</span>
<a name="line-77"></a><span class='hs-comment'>--   For example:</span>
<a name="line-78"></a><span class='hs-comment'>--</span>
<a name="line-79"></a><span class='hs-comment'>-- &gt; keysResizeWindow (10, 0) (0, 0)      -- make the window 10 pixels larger to the right</span>
<a name="line-80"></a><span class='hs-comment'>-- &gt; keysResizeWindow (10, 0) (0, 1%2)    -- does the same, unless sizeHints are applied</span>
<a name="line-81"></a><span class='hs-comment'>-- &gt; keysResizeWindow (10, 10) (1%2, 1%2) -- add 5 pixels on each side</span>
<a name="line-82"></a><span class='hs-comment'>-- &gt; keysResizeWindow (-10, -10) (0, 1)   -- shrink the window in direction of the bottom-left corner</span>
<a name="line-83"></a><span class='hs-definition'>keysResizeWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>G</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-84"></a><span class='hs-definition'>keysResizeWindow</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>keysMoveResize</span> <span class='hs-varid'>keysResizeWindow'</span>
<a name="line-85"></a>
<a name="line-86"></a><a name="keysAbsResizeWindow"></a><span class='hs-comment'>-- | @keysAbsResizeWindow (dx, dy) (ax, ay)@ changes the width by @dx@</span>
<a name="line-87"></a><span class='hs-comment'>--   and the height by @dy@, leaving the screen absolute point @(ax,</span>
<a name="line-88"></a><span class='hs-comment'>--   ay)@ fixed.</span>
<a name="line-89"></a><span class='hs-comment'>--</span>
<a name="line-90"></a><span class='hs-comment'>--   For example:</span>
<a name="line-91"></a><span class='hs-comment'>--</span>
<a name="line-92"></a><span class='hs-comment'>-- &gt; keysAbsResizeWindow (10, 10) (0, 0)   -- enlarge the window; if it is not in the top-left corner it will also be moved down and to the right.</span>
<a name="line-93"></a><span class='hs-definition'>keysAbsResizeWindow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-94"></a><span class='hs-definition'>keysAbsResizeWindow</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>keysMoveResize</span> <span class='hs-varid'>keysAbsResizeWindow'</span>
<a name="line-95"></a>
<a name="line-96"></a><a name="keysAbsResizeWindow'"></a><span class='hs-definition'>keysAbsResizeWindow'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SizeHints</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>P</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span><span class='hs-layout'>,</span><span class='hs-conid'>D</span><span class='hs-layout'>)</span>
<a name="line-97"></a><span class='hs-definition'>keysAbsResizeWindow'</span> <span class='hs-varid'>sh</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span><span class='hs-layout'>,</span><span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>dx</span><span class='hs-layout'>,</span><span class='hs-varid'>dy</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ax</span><span class='hs-layout'>,</span> <span class='hs-varid'>ay</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>round</span> <span class='hs-varid'>nx</span><span class='hs-layout'>,</span> <span class='hs-varid'>round</span> <span class='hs-varid'>ny</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>nw</span><span class='hs-layout'>,</span> <span class='hs-varid'>nh</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-98"></a>    <span class='hs-keyword'>where</span>
<a name="line-99"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>nw</span><span class='hs-layout'>,</span> <span class='hs-varid'>nh</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>applySizeHintsContents</span> <span class='hs-varid'>sh</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span> <span class='hs-varop'>+</span> <span class='hs-varid'>dx</span><span class='hs-layout'>,</span> <span class='hs-varid'>h</span> <span class='hs-varop'>+</span> <span class='hs-varid'>dy</span><span class='hs-layout'>)</span>
<a name="line-100"></a>        <span class='hs-varid'>nx</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Rational</span>
<a name="line-101"></a>        <span class='hs-varid'>nx</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>ax</span> <span class='hs-varop'>*</span> <span class='hs-varid'>w</span> <span class='hs-varop'>+</span> <span class='hs-varid'>nw</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span> <span class='hs-comment'>-</span> <span class='hs-varid'>ax</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>/</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>w</span>
<a name="line-102"></a>        <span class='hs-varid'>ny</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Rational</span>
<a name="line-103"></a>        <span class='hs-varid'>ny</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-varid'>ay</span> <span class='hs-varop'>*</span> <span class='hs-varid'>h</span> <span class='hs-varop'>+</span> <span class='hs-varid'>nh</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>y</span> <span class='hs-comment'>-</span> <span class='hs-varid'>ay</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>/</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>h</span>
<a name="line-104"></a>
<a name="line-105"></a><a name="keysResizeWindow'"></a><span class='hs-definition'>keysResizeWindow'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SizeHints</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>P</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>G</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span><span class='hs-layout'>,</span><span class='hs-conid'>D</span><span class='hs-layout'>)</span>
<a name="line-106"></a><span class='hs-definition'>keysResizeWindow'</span> <span class='hs-varid'>sh</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span><span class='hs-layout'>,</span><span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>dx</span><span class='hs-layout'>,</span><span class='hs-varid'>dy</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>gx</span><span class='hs-layout'>,</span> <span class='hs-varid'>gy</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>nx</span><span class='hs-layout'>,</span> <span class='hs-varid'>ny</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>nw</span><span class='hs-layout'>,</span> <span class='hs-varid'>nh</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-107"></a>    <span class='hs-keyword'>where</span>
<a name="line-108"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>nw</span><span class='hs-layout'>,</span> <span class='hs-varid'>nh</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>applySizeHintsContents</span> <span class='hs-varid'>sh</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span> <span class='hs-varop'>+</span> <span class='hs-varid'>dx</span><span class='hs-layout'>,</span> <span class='hs-varid'>h</span> <span class='hs-varop'>+</span> <span class='hs-varid'>dy</span><span class='hs-layout'>)</span>
<a name="line-109"></a>        <span class='hs-varid'>nx</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>round</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-varid'>gx</span> <span class='hs-varop'>*</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>w</span> <span class='hs-comment'>-</span> <span class='hs-varid'>gx</span> <span class='hs-varop'>*</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>nw</span>
<a name="line-110"></a>        <span class='hs-varid'>ny</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>round</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>y</span> <span class='hs-varop'>+</span> <span class='hs-varid'>gy</span> <span class='hs-varop'>*</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>h</span> <span class='hs-comment'>-</span> <span class='hs-varid'>gy</span> <span class='hs-varop'>*</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>nh</span>
<a name="line-111"></a>
<a name="line-112"></a><a name="keysMoveResize"></a><span class='hs-definition'>keysMoveResize</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>SizeHints</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>P</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>D</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>P</span><span class='hs-layout'>,</span><span class='hs-conid'>D</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-conid'>()</span>
<a name="line-113"></a><span class='hs-definition'>keysMoveResize</span> <span class='hs-varid'>f</span> <span class='hs-varid'>move</span> <span class='hs-varid'>resize</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>whenX</span> <span class='hs-layout'>(</span><span class='hs-varid'>isClient</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>withDisplay</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-114"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>raiseWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-115"></a>    <span class='hs-varid'>wa</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getWindowAttributes</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-116"></a>    <span class='hs-varid'>sh</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getWMNormalHints</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span>
<a name="line-117"></a>    <span class='hs-keyword'>let</span> <span class='hs-varid'>wa_dim</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>wa_width</span> <span class='hs-varid'>wa</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>wa_height</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span>
<a name="line-118"></a>        <span class='hs-varid'>wa_pos</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>wa_x</span> <span class='hs-varid'>wa</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>wa_y</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span>
<a name="line-119"></a>        <span class='hs-layout'>(</span><span class='hs-varid'>wn_pos</span><span class='hs-layout'>,</span> <span class='hs-varid'>wn_dim</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>sh</span> <span class='hs-varid'>wa_pos</span> <span class='hs-varid'>wa_dim</span> <span class='hs-varid'>move</span> <span class='hs-varid'>resize</span>
<a name="line-120"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>resizeWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span> <span class='hs-varop'>`uncurry`</span> <span class='hs-varid'>wn_dim</span>
<a name="line-121"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>moveWindow</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span> <span class='hs-varop'>`uncurry`</span> <span class='hs-varid'>wn_pos</span>
<a name="line-122"></a>    <span class='hs-varid'>float</span> <span class='hs-varid'>w</span>
<a name="line-123"></a>
</pre></body>
</html>
