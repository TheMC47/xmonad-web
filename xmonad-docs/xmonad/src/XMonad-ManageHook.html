<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>XMonad/ManageHook.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-4"></a><span class='hs-comment'>-- |</span>
<a name="line-5"></a><span class='hs-comment'>-- Module      :  XMonad.ManageHook</span>
<a name="line-6"></a><span class='hs-comment'>-- Copyright   :  (c) Spencer Janssen 2007</span>
<a name="line-7"></a><span class='hs-comment'>-- License     :  BSD3-style (see LICENSE)</span>
<a name="line-8"></a><span class='hs-comment'>--</span>
<a name="line-9"></a><span class='hs-comment'>-- Maintainer  :  spencerjanssen@gmail.com</span>
<a name="line-10"></a><span class='hs-comment'>-- Stability   :  unstable</span>
<a name="line-11"></a><span class='hs-comment'>-- Portability :  not portable, uses cunning newtype deriving</span>
<a name="line-12"></a><span class='hs-comment'>--</span>
<a name="line-13"></a><span class='hs-comment'>-- An EDSL for ManageHooks</span>
<a name="line-14"></a><span class='hs-comment'>--</span>
<a name="line-15"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-16"></a>
<a name="line-17"></a><span class='hs-comment'>-- XXX examples required</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>ManageHook</span> <span class='hs-keyword'>where</span>
<a name="line-20"></a>
<a name="line-21"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>catch</span><span class='hs-layout'>)</span>
<a name="line-22"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>Core</span>
<a name="line-23"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>X11</span><span class='hs-varop'>.</span><span class='hs-conid'>Xlib</span><span class='hs-varop'>.</span><span class='hs-conid'>Extras</span>
<a name="line-24"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>X11</span><span class='hs-varop'>.</span><span class='hs-conid'>Xlib</span> <span class='hs-layout'>(</span><span class='hs-conid'>Display</span><span class='hs-layout'>,</span> <span class='hs-conid'>Window</span><span class='hs-layout'>,</span> <span class='hs-varid'>internAtom</span><span class='hs-layout'>,</span> <span class='hs-varid'>wM_NAME</span><span class='hs-layout'>)</span>
<a name="line-25"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Exception</span><span class='hs-varop'>.</span><span class='hs-conid'>Extensible</span> <span class='hs-layout'>(</span><span class='hs-varid'>bracket</span><span class='hs-layout'>,</span> <span class='hs-varid'>catch</span><span class='hs-layout'>,</span> <span class='hs-conid'>SomeException</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-26"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Monad</span><span class='hs-varop'>.</span><span class='hs-conid'>Reader</span>
<a name="line-27"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Maybe</span>
<a name="line-28"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Monoid</span>
<a name="line-29"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>StackSet</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>W</span>
<a name="line-30"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>XMonad</span><span class='hs-varop'>.</span><span class='hs-conid'>Operations</span> <span class='hs-layout'>(</span><span class='hs-varid'>floatLocation</span><span class='hs-layout'>,</span> <span class='hs-varid'>reveal</span><span class='hs-layout'>)</span>
<a name="line-31"></a>
<a name="line-32"></a><a name="liftX"></a><span class='hs-comment'>-- | Lift an 'X' action to a 'Query'.</span>
<a name="line-33"></a><span class='hs-definition'>liftX</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>X</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Query</span> <span class='hs-varid'>a</span>
<a name="line-34"></a><span class='hs-definition'>liftX</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Query</span> <span class='hs-varop'>.</span> <span class='hs-varid'>lift</span>
<a name="line-35"></a>
<a name="line-36"></a><a name="idHook"></a><span class='hs-comment'>-- | The identity hook that returns the WindowSet unchanged.</span>
<a name="line-37"></a><span class='hs-definition'>idHook</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monoid</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span>
<a name="line-38"></a><span class='hs-definition'>idHook</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mempty</span>
<a name="line-39"></a>
<a name="line-40"></a><a name="%3c+%3e"></a><span class='hs-comment'>-- | Infix 'mappend'. Compose two 'ManageHook' from right to left.</span>
<a name="line-41"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;+&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monoid</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span>
<a name="line-42"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;+&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mappend</span>
<a name="line-43"></a>
<a name="line-44"></a><a name="composeAll"></a><span class='hs-comment'>-- | Compose the list of 'ManageHook's.</span>
<a name="line-45"></a><span class='hs-definition'>composeAll</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monoid</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>m</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span>
<a name="line-46"></a><span class='hs-definition'>composeAll</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mconcat</span>
<a name="line-47"></a>
<a name="line-48"></a><span class='hs-keyword'>infix</span> <span class='hs-num'>0</span> <span class='hs-varop'>--&gt;</span>
<a name="line-49"></a>
<a name="line-50"></a><a name="--%3e"></a><span class='hs-comment'>-- | @p --&gt; x@.  If @p@ returns 'True', execute the 'ManageHook'.</span>
<a name="line-51"></a><span class='hs-comment'>--</span>
<a name="line-52"></a><span class='hs-comment'>-- &gt; (--&gt;) :: Monoid m =&gt; Query Bool -&gt; Query m -&gt; Query m -- a simpler type</span>
<a name="line-53"></a><span class='hs-layout'>(</span><span class='hs-varop'>--&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Monad</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>Monoid</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-54"></a><a name="p"></a><span class='hs-definition'>p</span> <span class='hs-varop'>--&gt;</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>f</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>return</span> <span class='hs-varid'>mempty</span>
<a name="line-55"></a>
<a name="line-56"></a><a name="=?"></a><span class='hs-comment'>-- | @q =? x@. if the result of @q@ equals @x@, return 'True'.</span>
<a name="line-57"></a><span class='hs-layout'>(</span><span class='hs-varop'>=?</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Query</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Query</span> <span class='hs-conid'>Bool</span>
<a name="line-58"></a><a name="q"></a><span class='hs-definition'>q</span> <span class='hs-varop'>=?</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>q</span>
<a name="line-59"></a>
<a name="line-60"></a><span class='hs-keyword'>infixr</span> <span class='hs-num'>3</span> <span class='hs-varop'>&lt;&amp;&amp;&gt;</span><span class='hs-layout'>,</span> <span class='hs-varop'>&lt;||&gt;</span>
<a name="line-61"></a>
<a name="line-62"></a><a name="%3c&&%3e"></a><span class='hs-comment'>-- | '&amp;&amp;' lifted to a 'Monad'.</span>
<a name="line-63"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&amp;&amp;&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monad</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Bool</span>
<a name="line-64"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&amp;&amp;&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftM2</span> <span class='hs-layout'>(</span><span class='hs-varop'>&amp;&amp;</span><span class='hs-layout'>)</span>
<a name="line-65"></a>
<a name="line-66"></a><a name="%3c%7c%7c%3e"></a><span class='hs-comment'>-- | '||' lifted to a 'Monad'.</span>
<a name="line-67"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;||&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Monad</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>Bool</span>
<a name="line-68"></a><span class='hs-layout'>(</span><span class='hs-varop'>&lt;||&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftM2</span> <span class='hs-layout'>(</span><span class='hs-varop'>||</span><span class='hs-layout'>)</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="title"></a><span class='hs-comment'>-- | Return the window title.</span>
<a name="line-71"></a><span class='hs-definition'>title</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span> <span class='hs-conid'>String</span>
<a name="line-72"></a><span class='hs-definition'>title</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ask</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>w</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>liftX</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-73"></a>    <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>asks</span> <span class='hs-varid'>display</span>
<a name="line-74"></a>    <span class='hs-keyword'>let</span>
<a name="line-75"></a>        <span class='hs-varid'>getProp</span> <span class='hs-keyglyph'>=</span>
<a name="line-76"></a>            <span class='hs-layout'>(</span><span class='hs-varid'>internAtom</span> <span class='hs-varid'>d</span> <span class='hs-str'>"_NET_WM_NAME"</span> <span class='hs-conid'>False</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-varid'>getTextProperty</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-77"></a>                <span class='hs-varop'>`catch`</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-conid'>SomeException</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>getTextProperty</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span> <span class='hs-varid'>wM_NAME</span>
<a name="line-78"></a>        <span class='hs-varid'>extract</span> <span class='hs-varid'>prop</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>wcTextPropertyToTextList</span> <span class='hs-varid'>d</span> <span class='hs-varid'>prop</span>
<a name="line-79"></a>                          <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>null</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>then</span> <span class='hs-str'>""</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>head</span> <span class='hs-varid'>l</span>
<a name="line-80"></a>    <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>bracket</span> <span class='hs-varid'>getProp</span> <span class='hs-layout'>(</span><span class='hs-varid'>xFree</span> <span class='hs-varop'>.</span> <span class='hs-varid'>tp_value</span><span class='hs-layout'>)</span> <span class='hs-varid'>extract</span> <span class='hs-varop'>`catch`</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-conid'>SomeException</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-str'>""</span>
<a name="line-81"></a>
<a name="line-82"></a><a name="appName"></a><span class='hs-comment'>-- | Return the application name.</span>
<a name="line-83"></a><span class='hs-definition'>appName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span> <span class='hs-conid'>String</span>
<a name="line-84"></a><span class='hs-definition'>appName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ask</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>w</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>liftX</span> <span class='hs-varop'>$</span> <span class='hs-varid'>withDisplay</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>resName</span> <span class='hs-varop'>$</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getClassHint</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-85"></a>
<a name="line-86"></a><a name="resource"></a><span class='hs-comment'>-- | Backwards compatible alias for 'appName'.</span>
<a name="line-87"></a><span class='hs-definition'>resource</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span> <span class='hs-conid'>String</span>
<a name="line-88"></a><span class='hs-definition'>resource</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>appName</span>
<a name="line-89"></a>
<a name="line-90"></a><a name="className"></a><span class='hs-comment'>-- | Return the resource class.</span>
<a name="line-91"></a><span class='hs-definition'>className</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span> <span class='hs-conid'>String</span>
<a name="line-92"></a><span class='hs-definition'>className</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ask</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>w</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>liftX</span> <span class='hs-varop'>$</span> <span class='hs-varid'>withDisplay</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>resClass</span> <span class='hs-varop'>$</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getClassHint</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-93"></a>
<a name="line-94"></a><a name="stringProperty"></a><span class='hs-comment'>-- | A query that can return an arbitrary X property of type 'String',</span>
<a name="line-95"></a><span class='hs-comment'>--   identified by name.</span>
<a name="line-96"></a><span class='hs-definition'>stringProperty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Query</span> <span class='hs-conid'>String</span>
<a name="line-97"></a><span class='hs-definition'>stringProperty</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ask</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>w</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>liftX</span> <span class='hs-varop'>$</span> <span class='hs-varid'>withDisplay</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-str'>""</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getStringProperty</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-98"></a>
<a name="line-99"></a><a name="getStringProperty"></a><span class='hs-definition'>getStringProperty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Display</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Window</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>X</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<a name="line-100"></a><span class='hs-definition'>getStringProperty</span> <span class='hs-varid'>d</span> <span class='hs-varid'>w</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-101"></a>  <span class='hs-varid'>a</span>  <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getAtom</span> <span class='hs-varid'>p</span>
<a name="line-102"></a>  <span class='hs-varid'>md</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>io</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getWindowProperty8</span> <span class='hs-varid'>d</span> <span class='hs-varid'>a</span> <span class='hs-varid'>w</span>
<a name="line-103"></a>  <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>toEnum</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fromIntegral</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>md</span>
<a name="line-104"></a>
<a name="line-105"></a><a name="doF"></a><span class='hs-comment'>-- | Modify the 'WindowSet' with a pure function.</span>
<a name="line-106"></a><span class='hs-definition'>doF</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Query</span> <span class='hs-layout'>(</span><span class='hs-conid'>Endo</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>
<a name="line-107"></a><span class='hs-definition'>doF</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>return</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Endo</span>
<a name="line-108"></a>
<a name="line-109"></a><a name="doFloat"></a><span class='hs-comment'>-- | Move the window to the floating layer.</span>
<a name="line-110"></a><span class='hs-definition'>doFloat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ManageHook</span>
<a name="line-111"></a><span class='hs-definition'>doFloat</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ask</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>w</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>doF</span> <span class='hs-varop'>.</span> <span class='hs-conid'>W</span><span class='hs-varop'>.</span><span class='hs-varid'>float</span> <span class='hs-varid'>w</span> <span class='hs-varop'>.</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>=&lt;&lt;</span> <span class='hs-varid'>liftX</span> <span class='hs-layout'>(</span><span class='hs-varid'>floatLocation</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-112"></a>
<a name="line-113"></a><a name="doIgnore"></a><span class='hs-comment'>-- | Map the window and remove it from the 'WindowSet'.</span>
<a name="line-114"></a><span class='hs-definition'>doIgnore</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ManageHook</span>
<a name="line-115"></a><span class='hs-definition'>doIgnore</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ask</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>w</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>liftX</span> <span class='hs-layout'>(</span><span class='hs-varid'>reveal</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>doF</span> <span class='hs-layout'>(</span><span class='hs-conid'>W</span><span class='hs-varop'>.</span><span class='hs-varid'>delete</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-116"></a>
<a name="line-117"></a><a name="doShift"></a><span class='hs-comment'>-- | Move the window to a given workspace</span>
<a name="line-118"></a><span class='hs-definition'>doShift</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WorkspaceId</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ManageHook</span>
<a name="line-119"></a><span class='hs-definition'>doShift</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>doF</span> <span class='hs-varop'>.</span> <span class='hs-conid'>W</span><span class='hs-varop'>.</span><span class='hs-varid'>shiftWin</span> <span class='hs-varid'>i</span> <span class='hs-varop'>=&lt;&lt;</span> <span class='hs-varid'>ask</span>
</pre></body>
</html>
